{"version":3,"file":"react.cjs.development.js","sources":["../src/context/MemberstackProvider.tsx","../src/hooks/useMemberstack.tsx","../src/context/MemberstackProtected.tsx","../src/hooks/useAuth.tsx","../src/hooks/useMember.tsx","../src/utils/index.ts","../src/hooks/useMemberstackModal/index.tsx","../src/hooks/payments/useCheckout.tsx","../src/hooks/payments/useCustomerPortal.tsx","../src/components/modal.tsx","../src/components/control/auth.tsx","../src/index.tsx"],"sourcesContent":["import React from \"react\";\nimport msDom from \"@memberstack/dom\";\n\ndeclare global {\n  interface Window { __MSDOM: any; }\n}\n\ntype Config = Parameters<typeof msDom[\"init\"]>;\n\ninterface MemberstackProviderProps {\n  config: Config[0];\n  children: JSX.Element | JSX.Element[];\n}\n\nconst MemberstackContext = React.createContext<{\n  memberstack: null | ReturnType<typeof msDom[\"init\"]>;\n}>({ memberstack: null });\n\nexport const useMemberstackContext = () => {\n  return React.useContext(MemberstackContext);\n};\n\nexport const MemberstackProvider = (props: MemberstackProviderProps) => {\n  const memberstack = msDom.init(props.config);\n\n  React.useEffect(() => {\n    const loader = setInterval(() => {\n      if (!window.__MSDOM?.load && !document.getElementById(\"_ms-iframe\")) {\n        window.__MSDOM?.load({ publicKey: (props.config as { publicKey: string }).publicKey });\n      } else {\n        clearInterval(loader);\n      }\n    }, 200);\n\n    return () => clearInterval(loader);\n  }, []);\n\n  return (\n    <MemberstackContext.Provider value={{ memberstack }}>\n      {props.children}\n    </MemberstackContext.Provider>\n  );\n};\n","import { useMemberstackContext } from \"../context/MemberstackProvider\";\n\nexport const useMemberstack = () => {\n  const { memberstack } = useMemberstackContext();\n\n  if (!memberstack) {\n    throw new Error(\"useMemberstack can only be used within <MemberstackProvider>\");\n  }\n\n  return memberstack;\n};\n","import React from \"react\";\nimport { useMemberstack } from \"../hooks/useMemberstack\";\n\ninterface MemberstackProtectedProps {\n  allow?: {\n    permissions?: string[];\n    plans?: string[];\n  };\n  onUnauthorized?: (x?: any) => any | JSX.Element | JSX.Element[];\n  children: JSX.Element | JSX.Element[];\n  fallback?: JSX.Element | JSX.Element[];\n}\n\nenum State {\n  LOADING = \"LOADING\",\n  UNAUTHORIZED = \"UNAUTHORIZED\",\n  AUTHORIZED = \"AUTHORIZED\",\n}\n\nexport const MemberstackProtected = (props: MemberstackProtectedProps) => {\n  const memberstack = useMemberstack();\n  const [state, setState] = React.useState(State.LOADING);\n\n  if (!memberstack) {\n    throw new Error(\"<MemberstackProtected> can only be used within <MemberstackProvider>\");\n  }\n\n  function getMemberAuthorization(member) {\n    if (!member) {\n      setState(State.UNAUTHORIZED);\n      return;\n    }\n\n    const { permissions, plans } = props.allow || {};\n\n    if (permissions?.length) {\n      if (!permissions.some((per) => (member?.permissions as string[])?.includes(per))) {\n        setState(State.UNAUTHORIZED);\n        return;\n      }\n    }\n\n    if (plans?.length) {\n      if (!plans.some((planId) => member?.planConnections?.find((con) => con.planId === planId))) {\n        setState(State.UNAUTHORIZED);\n        return;\n      }\n    }\n\n    setState(member ? State.AUTHORIZED : State.UNAUTHORIZED);\n  }\n\n  async function getMember() {\n    const { data: member } = await memberstack.getCurrentMember();\n    getMemberAuthorization(member);\n  }\n\n  React.useEffect(() => {\n    let isMounted = true;\n    let listener;\n\n    if (isMounted) {\n      listener = memberstack?.onAuthChange(getMemberAuthorization);\n      getMember();\n    }\n\n    return () => {\n      isMounted = false;\n      listener?.unsubscribe();\n    };\n  }, []);\n\n  switch (state) {\n    case State.LOADING:\n      return props.fallback || null;\n\n    case State.AUTHORIZED:\n      return props.children;\n\n    case State.UNAUTHORIZED:\n      if (React.isValidElement(props.onUnauthorized)) {\n        return props.onUnauthorized;\n      }\n\n      if (typeof props.onUnauthorized === \"function\") {\n        props.onUnauthorized();\n      }\n\n      return null;\n    default:\n      return null;\n  }\n};\n","import React from \"react\";\nimport { useMemberstack } from \"./useMemberstack\";\n\nexport enum State {\n  LOADING = \"LOADING\",\n  UNAUTHORIZED = \"UNAUTHORIZED\",\n  AUTHORIZED = \"AUTHORIZED\",\n}\n\nexport const useAuth = () => {\n  const memberstack = useMemberstack();\n  const [auth, setAuth] = React.useState<any>(null);\n\n  function getMemberAuthorization(currentMember: any) {\n    currentMember\n      ? setAuth({\n          userId: currentMember.id,\n          status: State.AUTHORIZED,\n        })\n      : setAuth({\n          userId: null,\n          status: State.UNAUTHORIZED,\n        });\n    return;\n  }\n\n  async function getMember() {\n    const { data: currentMember } = await memberstack.getCurrentMember();\n    getMemberAuthorization(currentMember);\n  }\n\n  React.useEffect(() => {\n    let isMounted = true;\n    let listener;\n\n    if (isMounted) {\n      listener = memberstack?.onAuthChange(getMemberAuthorization);\n      getMember();\n    }\n\n    return () => {\n      isMounted = false;\n      listener?.unsubscribe();\n    };\n  }, []);\n\n  return {\n    ...auth,\n    isLoggedIn: auth?.status === State.AUTHORIZED,\n    getToken: () => memberstack.getMemberCookie(),\n    signOut: async () => await memberstack.logout(),\n  };\n};\n","import React from \"react\";\nimport { useMemberstack } from \"./useMemberstack\";\n\nexport const useMember = () => {\n  const memberstack = useMemberstack();\n  const [member, setMember] = React.useState<any>(null);\n  const [memberJSON, setMemberJSON] = React.useState<any>(null);\n\n  async function getMember() {\n    try {\n      const { data: currentMember } = await memberstack.getCurrentMember();\n      currentMember ? setMember(currentMember) : setMember(null);\n      const { data: jsonData } = await memberstack.getMemberJSON();\n      jsonData ? setMemberJSON(jsonData?.json) : setMemberJSON(null);\n    } catch (err) {\n      console.log(err);\n    }\n  }\n\n  React.useEffect(() => {\n    getMember();\n  }, []);\n\n  return {\n    member,\n    memberJSON,\n    updateEmail: async (email: string) => await memberstack.updateMemberAuth({ email }),\n    updatePassword: async (oldPassword: string, newPassword: string) =>\n      await memberstack.updateMemberAuth({ oldPassword, newPassword }),\n    updateMetadata: async (metaData: any) => await memberstack.updateMember({ metaData }),\n    updateCustomFields: async (customFields: any) =>\n      await memberstack.updateMember({ customFields }),\n    updateMemberJSON: async (json: object) => await memberstack.updateMemberJSON({ json }),\n  };\n};\n","// if includeFalseVals is true, then the returned array will\n// include false values and zero values || exclude undefined and null values\n// otherwise, it will only return truthy values.\n\ninterface IFilterNullableValues {\n  includeFalseVals?: boolean;\n}\n\nexport const filterNullableValues = (\n  obj: any,\n  { includeFalseVals = false }: IFilterNullableValues = {}\n) =>\n  Object.entries(obj)\n    .filter(([, y]) => (includeFalseVals ? y !== null && y !== undefined : y))\n    .reduce((acc, cur) => ({ ...acc, [cur[0]]: cur[1] }), {});\n","import React from \"react\";\nimport { useMemberstack } from \"../useMemberstack\";\nimport { filterNullableValues } from \"../../utils\";\n// import { useMutationObservable } from \"./useMutationObservable\";\n\nexport interface ModalMethods {\n  onCompleted?: (x: any) => any;\n  onError?: (x: { code: string; message: string }) => any;\n}\n\nexport interface ForgotModalProps {\n  type: \"FORGOT_PASSWORD\";\n}\n\nexport interface LoginModalProps {\n  type: \"LOGIN\";\n  planId?: string;\n  priceId?: string;\n}\n\nexport interface SignupModalProps {\n  type: \"SIGNUP\";\n  planId?: string;\n  priceId?: string;\n}\n\nexport interface ProfileModalProps {\n  type: \"PROFILE\";\n}\n\nexport const useMemberstackModal = () => {\n  const memberstack = useMemberstack();\n\n  const config = React.useRef(null);\n  const [show, setShow] = React.useState(false);\n\n  function openModal(\n    openModalProps?: (ForgotModalProps | LoginModalProps | SignupModalProps | ProfileModalProps) &\n      ModalMethods\n  ) {\n    config.current = filterNullableValues({\n      ...config.current,\n      type: openModalProps.type,\n      planId: (openModalProps as LoginModalProps | SignupModalProps).planId,\n      priceId: (openModalProps as LoginModalProps | SignupModalProps).priceId,\n      onCompleted: openModalProps.onCompleted,\n      onError: openModalProps.onError,\n    });\n\n    setShow(true);\n    // @ts-ignore\n    //if (!loaded || visible) return;\n\n    return memberstack.openModal(\n      config.current.type,\n      filterNullableValues({\n        planId: config.current.planId,\n        priceId: config.current.priceId,\n      })\n      // filterNullableValues({\n      //   onCompleted: config.current.onCompleted,\n      //   onError: config.current.onError,\n      // })\n    );\n  }\n\n  function hideModal() {\n    setShow(false);\n    return memberstack.hideModal();\n  }\n\n  return {\n    openModal,\n    hideModal,\n  };\n};\n","import { useMemberstack } from \"../useMemberstack\";\nimport { filterNullableValues } from \"../../utils\";\n\nexport type PurchasePlansWithCheckoutParams = {\n  priceId: string;\n  cancelUrl?: string;\n  successUrl?: string;\n  autoRedirect?: boolean;\n};\n\nexport const useCheckout = () => {\n  const memberstack = useMemberstack();\n\n  const checkout = async (params: PurchasePlansWithCheckoutParams) =>\n    await memberstack.purchasePlansWithCheckout(\n      //@ts-ignore\n      filterNullableValues(\n        {\n          priceId: params.priceId,\n          cancelUrl: params.cancelUrl,\n          successUrl: params.successUrl,\n          autoRedirect: params.autoRedirect,\n        },\n        { includeFalseVals: true }\n      )\n    );\n\n  return checkout;\n};\n","import { useMemberstack } from \"../useMemberstack\";\nimport { filterNullableValues } from \"../../utils\";\n\nexport type LaunchStripeCustomerPortalParams = {\n  priceIds: string[];\n  returnUrl?: string;\n  autoRedirect?: boolean;\n};\n\nexport const useCustomerPortal = (params: LaunchStripeCustomerPortalParams) => {\n  const memberstack = useMemberstack();\n\n  const launchPortal = async () =>\n    await memberstack.launchStripeCustomerPortal(\n      //@ts-ignore\n      filterNullableValues(\n        {\n          priceIds: params.priceIds,\n          returnUrl: params.returnUrl,\n          autoRedirect: params.autoRedirect,\n        },\n        { includeFalseVals: true }\n      )\n    );\n\n  return launchPortal;\n};\n","import React from \"react\";\nimport {\n  useMemberstackModal,\n  ModalMethods,\n  SignupModalProps,\n  LoginModalProps,\n  ProfileModalProps,\n  ForgotModalProps,\n} from \"../hooks/useMemberstackModal\";\n\nexport interface ModalType {\n  type: \"LOGIN\" | \"SIGNUP\" | \"FORGOT_PASSWORD\" | \"PROFILE\";\n}\n\nconst modalFactory = ({ type }: ModalType) => {\n  return function ModalComponent(\n    props: (LoginModalProps | SignupModalProps | ProfileModalProps | ForgotModalProps) &\n      ModalMethods\n  ) {\n    const { openModal, hideModal } = useMemberstackModal();\n    React.useEffect(() => {\n      openModal({\n        type,\n        planId: (props as LoginModalProps | SignupModalProps).planId,\n        priceId: (props as LoginModalProps | SignupModalProps).priceId\n      }).then(({ data, type }) => hideModal());\n    }, []);\n\n    return null;\n  };\n};\n\nexport const SignInModal = modalFactory({ type: \"LOGIN\" });\nexport const SignUpModal = modalFactory({ type: \"SIGNUP\" });\nexport const ProfileModal = modalFactory({ type: \"PROFILE\" });\n","import React from \"react\";\nimport { useAuth, State } from \"../../hooks/useAuth\";\n\ninterface AuthLogicProps {\n  children: JSX.Element | JSX.Element[];\n  fallback?: JSX.Element | JSX.Element[];\n}\n\nconst logicWrapper = (fn: (x: any) => any) => {\n  return function LogicWrapper(props: AuthLogicProps) {\n    const auth = useAuth();\n    const condition = React.useMemo(() => fn(auth), [auth]);\n    if (auth.status === State.LOADING) {\n      return props.fallback || null;\n    }\n    return condition ? props.children : null;\n  };\n};\n\nexport const LoggedIn = logicWrapper((auth) => auth.isLoggedIn);\nexport const LoggedOut = logicWrapper((auth) => !auth.isLoggedIn);\n","console.log(\"Memberstack React has initialized\");\nexport { MemberstackProvider } from \"./context/MemberstackProvider\";\nexport { MemberstackProtected } from \"./context/MemberstackProtected\";\nexport {\n  useAuth,\n  useMember,\n  useMemberstack,\n  useMemberstackModal,\n  useCheckout,\n  useCustomerPortal,\n} from \"./hooks\";\nexport { SignInModal, SignUpModal, ProfileModal } from \"./components/modal\";\nexport { LoggedIn, LoggedOut } from \"./components/control/auth\";\n"],"names":["MemberstackContext","React","createContext","memberstack","useMemberstackContext","useContext","MemberstackProvider","props","msDom","init","config","useEffect","loader","setInterval","window","__MSDOM","load","document","getElementById","publicKey","clearInterval","Provider","value","children","useMemberstack","Error","State","MemberstackProtected","useState","LOADING","state","setState","getMemberAuthorization","member","UNAUTHORIZED","allow","permissions","plans","length","some","per","includes","planId","planConnections","find","con","AUTHORIZED","getMember","getCurrentMember","data","isMounted","listener","onAuthChange","unsubscribe","fallback","isValidElement","onUnauthorized","useAuth","auth","setAuth","currentMember","userId","id","status","isLoggedIn","getToken","getMemberCookie","signOut","logout","useMember","setMember","memberJSON","setMemberJSON","getMemberJSON","jsonData","json","console","log","updateEmail","email","updateMemberAuth","updatePassword","oldPassword","newPassword","updateMetadata","metaData","updateMember","updateCustomFields","customFields","updateMemberJSON","filterNullableValues","obj","includeFalseVals","Object","entries","filter","y","undefined","reduce","acc","cur","useMemberstackModal","useRef","show","setShow","openModal","openModalProps","current","type","priceId","onCompleted","onError","hideModal","useCheckout","checkout","params","purchasePlansWithCheckout","cancelUrl","successUrl","autoRedirect","useCustomerPortal","launchPortal","launchStripeCustomerPortal","priceIds","returnUrl","modalFactory","ModalComponent","then","SignInModal","SignUpModal","ProfileModal","logicWrapper","fn","LogicWrapper","condition","useMemo","LoggedIn","LoggedOut"],"mappings":"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"}